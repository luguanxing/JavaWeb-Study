<!DOCTYPE html>
<html lang="zh">

	<head>
		<title> 兴兴军用计算器 </title>
		<meta charset="utf-8" />
		<link href="style.css" type="text/css" rel="stylesheet" />
		<script src="script.js" type="text/javascript"></script>
	</head>
	
	<style>
		* {
			margin-left: auto;
			margin-right: auto;
		}

		body {
			text-align:center;
			margin-bottom: 50px;	
		}

		.calc {
			width:400px;
			height:500px;
			border:3px solid;
			border-radius:20pt;
			-webkit-box-shadow: 0px 10px 0px #030;	
			background:url("pictures/skin.jpg") repeat;
		}
			#screen {
				width:350px;
				height:80px;
				font-size:50pt;		
				margin-top:15px;
				resize: none;
				text-align:right;		
				overflow-x:scroll;
				overflow-y:hidden;
				white-space:nowrap;			
				border: 2px solid;
				border-radius:15pt;		
				background:-webkit-gradient(linear, 0% 0%, 100% 0%, from(#00c000), to(#006000));		
			}
			.buttons {
				width:350px;
				height:360px;
				margin-top:13px;		
				border:2px solid;
				border-radius:15pt;
				background-color:RGB(0,80,0);	
			}
				.buttons .button {
					float:left;				
					width:75px;
					height:60px;
					outline: none;			
					font-size:25pt;
					margin-top:10px;
					margin-left:10px;
					border-radius:20pt;
					-webkit-box-shadow: 0px 5px 0px #7a0;
					background:-webkit-gradient(linear, 0% 0%, 100% 100%,from(#00c400), to(#005000));
				}
				.buttons .button:active {
					top:5px;
					position:relative;
					-webkit-box-shadow: 0px 0px 0px;
				}	
		body ::-webkit-scrollbar    {
			margin-bottom:3px;
			background:-webkit-gradient(linear, 0% 0%, 100% 0%,from(#00c000), to(#006000));	
			border-radius:50%;	
		}

		body ::-webkit-scrollbar-thumb    { 
			display:none;
			border-radius:5pt;
		}		
	</style>
	
	<script language = "Javascript">
		MAX_INT = 9007199254740992;
		MIN_INT = -9007199254740992;
		function showstring(result) {
			document.getElementById("screen").value	= result;
			document.getElementById("screen").scrollLeft = document.getElementById("screen").scrollWidth;	
		}
		function addstring(result) {
			document.getElementById("screen").value += result;
			document.getElementById("screen").scrollLeft = document.getElementById("screen").scrollWidth;
		}
		function backstring() {
			var result = document.getElementById("screen").value;
			result = result.substring(0, result.length-1);
			document.getElementById("screen").value = result;
		}
		function isoperator(s) {
			if (!isNaN(s))
				return false;
			if (s == "(" || s == ")")
				return false;
			return true;
		}
		function check() {
			var string = document.getElementById("screen").value;
			if (string == "")
				return false;	
			else if (isNaN(string[0]) && string[0] != "(" && string[0] != "-")
				return false;
			else if (isNaN(string[string.length-1]) && string[string.length-1] != ")")
				return false;
			else {
				var leftbracket = 0, rightbracket = 0;
				for (var i = 0; i < string.length; i++) {
					if (i != 0 && isoperator(string[i]) && isoperator(string[i-1]))
						return false;
					if (string[i] == "(")
						leftbracket++;
					if (string[i] == ")")
						rightbracket++;			
				}
				if (leftbracket != rightbracket)
					return false;	
			}
			return true;
		}

		function setbutton() {
			var but=document.getElementsByClassName("button");
			for(i = 0; i <= 17; i++) {
				if (i == 14)
					continue;
				but[i].onclick = function(){
					addstring(this.getAttribute("id"));
				}
			}
			document.getElementById("←").onclick = function () {
				backstring();
			}
			document.getElementById("CE").onclick = function () {
				showstring("");
			}
			document.getElementById("=").onclick = function() {
				try {
					if (check()) {
						var result = eval(document.getElementById("screen").value);
						if (MIN_INT < result && result < MAX_INT)
							showstring(parseFloat(result.toFixed(9)));
						else {
							alert("Overflow!");
							showstring("");
						}
					} else {
						alert("Error!");
						showstring("");
					}
				} catch (error) {
					alert("Error!!");
					showstring("");
				}
			}
		}
		window.onload = function() {
			showstring("");	
			setbutton();
		}

	</script>
	
	<body>
		<h1> 军用计算器 </h1>
		<div class = "calc">
			<textarea type="text" id="screen"> </textarea>				
			<div class = "buttons">
				<input type="button" value="7" class="button" id = "7">
				<input type="button" value="8" class="button" id = "8">
				<input type="button" value="9" class="button" id = "9">
				<input type="button" value="/" class="button" id = "/">
				<input type="button" value="4" class="button" id = "4">
				<input type="button" value="5" class="button" id = "5">
				<input type="button" value="6" class="button" id = "6">
				<input type="button" value="*" class="button" id = "*">
				<input type="button" value="1" class="button" id = "1">
				<input type="button" value="2" class="button" id = "2">
				<input type="button" value="3" class="button" id = "3">
				<input type="button" value="-" class="button" id = "-">
				<input type="button" value="0" class="button" id = "0">
				<input type="button" value="." class="button" id = ".">
				<input type="button" value="←" class="button" id = "←">
				<input type="button" value="+" class="button" id = "+">
				<input type="button" value="(" class="button" id = "(">
				<input type="button" value=")" class="button" id = ")">
				<input type="button" value="CE" class="button" id = "CE">
				<input type="button" value="=" class="button" id = "=">
			</div>			
		</div>
	</body>
</html>
